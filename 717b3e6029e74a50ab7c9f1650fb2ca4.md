id: 717b3e6029e74a50ab7c9f1650fb2ca4
parent_id: 
item_type: 1
item_id: e0b206fef36d40f8b1283a3cb1013b77
item_updated_time: 1643545212649
title_diff: "[{\"diffs\":[[1,\"AD Enumeration\"]],\"start1\":0,\"start2\":0,\"length1\":0,\"length2\":14}]"
body_diff: "[{\"diffs\":[[1,\"# <ins>Traditional Approach</ins>\\\n\\\n\\\\- use net user command to enumerate all local accounts, followed by net user /domain to list all domain accounts\\\n\\\n> net user /domain\\\n\\\nBased on the output, we will find out more about interesting individuals by\\\n\\\n> net user &lt;USERNAME&gt; /domain\\\n\\\nTo view the user groups available, use\\\n\\\n> net group /domain\\\n\\\n![3c675cd5e3d041a56f0dfe93c0233a5a.png](:/c8fd76099c964545a53ce3d2d3a34461)\\\n\\\n# <ins>Modern Approach</ins>\\\n\\\nUse Powershell methods - **Get-ADUser** (<ins>Only works on DC and requires admin rights</ins>)\\\n\\\nBuild a Powershell script to enumerate AD (can be used for assessment)\\\n\\\nIdea is to\\\n\\\n1.  Query network for the name of Primary DC and domain,\\\n2.  search AD,\\\n3.  Filter output to display user accounts\\\n\\\n<ins>Step 1: Identify DC</ins>\\\n\\\nOn the compromised user account\\\n\\\n> \\\\[System.DirectoryServices.ActiveDirectory.Domain\\\\]::GetCurrent Domain()\\\n\\\n![885359a635cead6453f3b5f8f8ce0bd5.png](:/69f53989d7e640ae89ca7966b56843e8)\\\n\\\nUse DirectorySearcher Object to query via LDAP\\\n\\\n1.  Build the script using the information gained on the DC domain\\\n    \\\n2.  Use DirectorySearcher class by specifying a SearchRoot\\\n    \\\n3.  Setup a filter using 'samAccountType atrribute\\\n    \\\n    1.  In example, we use SAM_\\\n        USER\\\\_OBJECT and SAM\\\\_USER\\\\_NORMAL\\\\_ACCOUNT (0x30000000)\\\n        \\\n    2.  Refer to\\\n        \\\n        [https://msdn.microsoft.com/en-us/library/ms679637(v=vs.85).aspx](https://msdn.microsoft.com/en-us/library/ms679637%28v=vs.85%29.aspx) for more examples)\\\n        \\\n4.  Clear the output by iterating through the properties what info is available in it, creting a long list of details\\\n    \\\n\\\n`$domainObj = [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()`\\\n`$PDC = ($domainObj.PdcRoleOwner).Name`\\\n`$SearchString = \\\"LDAP://\\\"`\\\n`$SearchString += $PDC + \\\"/\\\"`\\\n`$DistinguishName = \\\"DC=$(domainObj.Name.Replace('.', ',DC='))\\\"`\\\n`$SearchString += $DistinguishName`\\\n`$Searcher = New-Object System.DirectoryServices.DirectorySearcher([ADSI]$SearchString)`\\\n`$objDomain = New-Object System.DirectoryServices.DirectoryEntry`\\\n`$Searcher.SearchRoot = $objDomain`\\\n\\\n$Searcher.filter=\\\"samAccountType=805306368\\\"\\\n\\\n$Searcher.FindAll()\\\n\\\n![12396b1b894ffbdb615072f633f4c85b.png](:/fa76ad55456645eb9d2ff5d5826dc1d9)\"]],\"start1\":0,\"start2\":0,\"length1\":0,\"length2\":2251}]"
metadata_diff: {"new":{"id":"e0b206fef36d40f8b1283a3cb1013b77","parent_id":"ac0bd99a1a324cb6a297fd05a2b92039","latitude":"1.33840000","longitude":"103.86280000","altitude":"0.0000","author":"","source_url":"","is_todo":0,"todo_due":0,"todo_completed":0,"source":"joplin-desktop","source_application":"net.cozic.joplin-desktop","application_data":"","order":0,"markup_language":1,"is_shared":0,"share_id":"","conflict_original_id":"","master_key_id":""},"deleted":[]}
encryption_cipher_text: 
encryption_applied: 0
updated_time: 2022-01-30T12:20:57.420Z
created_time: 2022-01-30T12:20:57.420Z
type_: 13