id: 8f38d1efcef042dfa50c4239da0fea6d
parent_id: a38bc1ee20664a46baeeab1c171b3aac
item_type: 1
item_id: 03e545fecf6c4b83aa0991000e1f94ba
item_updated_time: 1643855799539
title_diff: "[]"
body_diff: "[{\"diffs\":[[0,\"/System)\"],[1,\"\\\n\\\n```\\\n# Get all users in the current domain\\\nGet-DomainUser | select -ExpandProperty cn\\\n\\\n# Get all computers in the current domain\\\nGet-DomainComputer\\\n\\\n# Get all domains in current forest\\\nGet-ForestDomain\\\n\\\n# Get domain/forest trusts\\\nGet-DomainTrust\\\nGet-ForestTrust\\\n\\\n# Get information for the DA group\\\nGet-DomainGroup \\\"Domain Admins\\\"\\\n\\\n# Find members of the DA group\\\nGet-DomainGroupMember \\\"Domain Admins\\\" | select -ExpandProperty membername\\\n\\\n# Find interesting shares in the domain, ignore default shares, and check access\\\nFind-DomainShare -ExcludeStandard -ExcludePrint -ExcludeIPC -CheckShareAccess\\\n\\\n# Get OUs for current domain\\\nGet-DomainOU -FullData\\\n\\\n# Get computers in an OU\\\n# %{} is a looping statement\\\nGet-DomainOU -name Servers | %{ Get-DomainComputer -SearchBase $_.distinguishedname } | select dnshostname\\\n\\\n# Get GPOs applied to a specific OU\\\nGet-DomainOU *WS* | select gplink\\\nGet-DomainGPO -Name \\\"{3E04167E-C2B6-4A9A-8FB7-C811158DC97C}\\\"\\\n\\\n# Get Restricted Groups set via GPOs, look for interesting group memberships forced via domain\\\nGet-DomainGPOLocalGroup -ResolveMembersToSIDs | select GPODisplayName, GroupName, GroupMemberOf, GroupMembers\\\n\\\n# Get the computers where users are part of a local group through a GPO restricted group\\\nGet-DomainGPOUserLocalGroupMapping -LocalGroup Administrators | select ObjectName, GPODisplayName, ContainerName, ComputerName\\\n\\\n# Find principals that can create new GPOs in the domain\\\nGet-DomainObjectAcl -SearchBase \\\"CN=Policies,CN=System,DC=targetdomain,DC=com\\\" -ResolveGUIDs | ?{ $_.ObjectAceType -eq \\\"Group-Policy-Container\\\" } | select ObjectDN, ActiveDirectoryRights, SecurityIdentifier\\\n\\\n# Find principals that can link GPOs to OUs\\\nGet-DomainOU | Get-DomainObjectAcl -ResolveGUIDs | ? { $_.ObjectAceType -eq \\\"GP-Link\\\" -and $_.ActiveDirectoryRights -match \\\"WriteProperty\\\" } | select ObjectDN, SecurityIdentifier\\\n\\\n# Get incoming ACL for a specific object\\\nGet-DomainObjectAcl -SamAccountName \\\"Domain Admins\\\" -ResolveGUIDs | Select IdentityReference,ActiveDirectoryRights\\\n\\\n# Find interesting ACLs for the entire domain, show in a readable (left-to-right) format\\\nFind-InterestingDomainAcl | select identityreferencename,activedirectoryrights,acetype,objectdn | ?{$_.IdentityReferenceName -NotContains \\\"DnsAdmins\\\"} | ft\\\n\\\n# Get interesting outgoing ACLs for a specific user or group\\\n# ?{} is a filter statement\\\nFind-InterestingDomainAcl -ResolveGUIDs | ?{$_.IdentityReference -match \\\"Domain Admins\\\"} | select ObjectDN,ActiveDirectoryRights\\\n```\"]],\"start1\":120,\"start2\":120,\"length1\":8,\"length2\":2489}]"
metadata_diff: {"new":{},"deleted":[]}
encryption_cipher_text: 
encryption_applied: 0
updated_time: 2022-02-03T02:43:24.822Z
created_time: 2022-02-03T02:43:24.822Z
type_: 13